{"version":3,"sources":["../../../../assets/scripts/assets/scripts/room.js"],"names":["cc","Class","extends","Component","properties","out_bt","Button","voice_bt","talk_bt","ready_bt","no_ready_bt","play_bt","prefab_poker","Prefab","prefab_call_btn","pokers_layout","Layout","call_layout","call_node","Node","poker_up","Sprite","poker_left","poker_down","poker_right","up_lable","Label","left_lable","right_lable","pointer","onLoad","console","log","global","require","netControl","bind_event","onMessage","util","curr_poker_num","curr_poker","node","on","on_out_bt","on_ready_bt","on_no_ready_bt","on_play","load_pokers","p_1","poker","send","table","sit","length","p_2","p_3","p_4","id","that","pokers","loader","loadResDir","SpriteFrame","err","ress","p","name","onPoker","event","type","currentTarget","target","curr","getPosition","y","setPosition","arrayDel","indexOf","num","push","rm_poker","shift","director","loadScene","obj","data","JSON","parse","set_table","statu","removeAllChildren","pokersNode","instantiate","img","getChildByName","getComponent","spriteFrame","parent","EventType","TOUCH_START","TOUCH_MOVE","lun","index_my","rotation","currentplayer","index_curr","index","idx","right","up","left","player_up","player_left","player_right","string","currentCall","btn","lableNode","onCall","call","calls","i","onMajor","major","start"],"mappings":"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","file":"room.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        out_bt : cc.Button,\n        voice_bt : cc.Button,\n        talk_bt : cc.Button,\n        ready_bt : cc.Button,\n        no_ready_bt : cc.Button,\n        play_bt : cc.Button,\n\n        prefab_poker: cc.Prefab,\n        prefab_call_btn: cc.Prefab,\n\n        pokers_layout : cc.Layout,\n        call_layout : cc.Layout,\n        call_node : cc.Node,\n\n        poker_up : cc.Sprite,\n        poker_left : cc.Sprite,\n        poker_down : cc.Sprite,\n        poker_right : cc.Sprite,\n\n        up_lable : cc.Label,\n        left_lable : cc.Label,\n        right_lable : cc.Label,\n\n        pointer : cc.Node \n\n\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        \n        console.log('room onLoad');\n\n        this.global = require('./global');\n        this.netControl = require('./util/NetControl');\n        //绑定消息事件\n        this.netControl.bind_event('message',this.onMessage,this);\n\n        this.util = require('./util/util');\n        //绑定消息事件\n        // this.msssageFire=onfire.on(\"onmessage\",this.onMessage.bind(this));\n\n        //设置当前能选几张牌\n        this.curr_poker_num = 1;\n        //当前选中的牌\n        this.curr_poker = [];\n         \n         //按钮事件\n        this.out_bt.node.on('click',this.on_out_bt,this);\n        this.ready_bt.node.on('click',this.on_ready_bt,this);\n        this.no_ready_bt.node.on('click',this.on_no_ready_bt,this);\n        this.play_bt.node.on('click',this.on_play,this);\n        \n        //加载扑克牌图片资源\n        this.load_pokers();\n\n    },\n    on_play(){\n        if(this.curr_poker_num == 1){\n            //出牌\n            var p_1 = this.curr_poker[0].poker;\n            this.netControl.send('{\"method\":\"play\",\"roomId\":\"'+this.global.table+'\",\"sit\":\"'+this.global.sit+'\",\"play\":'+p_1+' }' );\n            //初始化选择的牌\n            this.curr_poker = [];\n        }else{\n            //扣牌\n            if(this.curr_poker.length == 4){\n\n                var p_1 = this.curr_poker[0].poker;\n                var p_2 = this.curr_poker[1].poker;\n                var p_3 = this.curr_poker[2].poker;\n                var p_4 = this.curr_poker[3].poker;\n\n                if(p_1%5 == 0 || p_1%100 == 14 || p_2%5 == 0 || p_2%100 == 14  || p_3%5 == 0 || p_3%100 == 14  || p_4%5 == 0 || p_4%100 == 14){\n                    // 不能扣分\n                    return ;\n                }\n                //初始化选择的牌\n                this.curr_poker = [];\n                this.netControl.send('{\"method\":\"holding\",\"roomId\":\"'+this.global.table+'\",\"sit\":\"'+this.global.sit+'\",\"holding\":['+p_1+','+p_2+','+p_3+','+p_4+'] }' );\n            }\n        }\n    },\n    //准备\n    on_ready_bt(){\n        this.netControl.send('{\"method\":\"ready\",\"roomId\":\"'+this.global.table+'\",\"sit\":\"'+this.global.sit+'\",\"playerId\":\"'+this.global.id+'\"}' );\n    },\n    //取消准备\n    on_no_ready_bt(){\n        this.netControl.send('{\"method\":\"noReady\",\"roomId\":\"'+this.global.table+'\",\"sit\":\"'+this.global.sit+'\",\"playerId\":\"'+this.global.id+'\"}' );\n    },\n    \n    //加载扑克牌资源\n    load_pokers(){\n\n        console.log('room load_pokers');\n\n        var that = this;\n        that.pokers = {};\n        cc.loader.loadResDir('pokers', cc.SpriteFrame, function (err, ress) {\n            for(var p of ress){\n                that.pokers[p.name] = p;\n            }\n            //获取当前桌的消息\n            that.netControl.send('{\"method\":\"table\",\"roomId\":\"'+that.global.table+'\"}');\n        });\n        \n\n        console.log(that.pokers );\n\n        \n    },\n   \n    //牌事件\n    onPoker(event){\n        console.log('room onPoker');\n\n\n        // console.log(event);\n        if(event.type == 'touchmove'){\n            if(event.currentTarget.poker != event.target.poker){\n                console.log(\"diff\");\n                console.log(currentTarget);\n                console.log(target);\n            }\n            return \n        }\n        // console.log(event);\n        //点击的节点\n        var curr = event.currentTarget;\n        //移动牌\n        var p = curr.getPosition();\n        if(p.y == 25){\n            curr.setPosition(0,0);\n            //删除取消的牌\n            this.curr_poker = this.util.arrayDel(this.curr_poker, this.curr_poker.indexOf(curr) );\n        }else{\n            //根据选牌数删除多余的牌\n            curr.setPosition(0,25);\n            var num = this.curr_poker.push(curr);\n            if(num > this.curr_poker_num){\n                var rm_poker = this.curr_poker.shift();\n                rm_poker.setPosition(0,0);\n            }\n        }\n    },\n\n    //退出按钮返回到大厅\n    on_out_bt(){\n        var netControl = require('./util/NetControl');\n        var global = require('./global');\n\n        netControl.send('{\"method\":\"out\",\"roomId\":\"'+global.table+'\",\"sit\":\"'+global.sit+'\",\"playerId\":\"'+global.name+'\"}');\n        cc.director.loadScene('hall');\n    },\n\n    onMessage:function(obj){\n        console.log('room onMessage');\n        var data = JSON.parse (obj.data);                  \n\n        if(data && data.table){\n            //返回桌子消息，则显示当前桌面的信息\n            this.set_table(data);\n        }\n    },\n\n    set_table:function(data){\n        console.log(data);\n        var sit = this.global.sit;\n        var pokers = [414,413,412,411,410,409,408,407,406,405,404,403,402];\n        if(data.statu != 'wait'){\n            pokers = data[\"player_\"+sit].pokers;\n        }\n        //显示玩家的牌\n        if(pokers){\n            this.pokers_layout.node.removeAllChildren();\n            for(var p of pokers){\n                var pokersNode = cc.instantiate(this.prefab_poker);\n                var img = pokersNode.getChildByName('img');\n                img.getComponent(cc.Sprite).spriteFrame = this.pokers[p];\n                img.poker = p;\n                pokersNode.parent = this.pokers_layout.node;\n                img.on(cc.Node.EventType.TOUCH_START, this.onPoker, this);\n                img.on(cc.Node.EventType.TOUCH_MOVE, this.onPoker, this);\n            }\n        }\n\n        //处理每个玩家\n        var sit = this.global.sit;\n\n        //计算每个玩家和当前玩家的相对位置\n        var lun = ['up','left','down','right'];\n\n        //指示当前出牌的人\n        var index_my = lun.indexOf(sit);\n        if( data.statu == 'wait' || data.statu == 'clear' ){\n            this.pointer.rotation = 90;\n        }else if(data.currentplayer ){\n            var index_curr = lun.indexOf(data.currentplayer);\n            this.pointer.rotation = (index_curr - index_my) * 90 + 90;\n        }else{\n            this.pointer.rotation = 90;\n        }\n\n        //显示桌面的info\n        //显示每个玩家出的牌\n        \n       \n        var index = lun.indexOf(sit);\n        var idx =  (index+1) >= lun.length ? (index+1-lun.length) : (index+1);\n        var right = lun[idx];\n        idx =  (index+2) >= lun.length ? (index+2-lun.length) : (index+2);\n        var up = lun[idx];\n        idx =  (index+3) >= lun.length ? (index+3-lun.length) : (index+3);\n        var left = lun[idx];\n\n        //显示每个玩家的名字\n        //显示 up \n        var player_up = data['player_'+up];\n        var player_left = data['player_'+left];\n        var player_right = data['player_'+right];\n\n        if( player_up ){\n            this.up_lable.string = player_up.name;\n        }else{\n            this.up_lable.string = '';\n        }\n        if( player_left ){\n            this.left_lable.string = player_left.name;\n        }else{\n            this.left_lable.string = '';\n        }\n        if( player_right ){\n            this.right_lable.string = player_right.name;\n        }else{\n            this.right_lable.string = '';\n        }\n\n        if(data.statu == 'call' && data.currentplayer == sit){\n            //当前是我叫\n            this.call_node.y = 0 ;\n            //生成叫分按钮\n            var currentCall = data.currentCall;\n            if(currentCall == 1){\n                currentCall = 0;\n            }\n\n            this.call_layout.node.removeAllChildren();\n\n            //不叫\n            var btn = cc.instantiate(this.prefab_call_btn);\n            btn.parent = this.call_layout.node ;\n            var lableNode = btn.getChildByName('Background').getChildByName('Label');\n            lableNode.getComponent(cc.Label).string = '不要' ;\n            btn.on(cc.Node.EventType.TOUCH_START, this.onCall, this);\n            btn.call = 0;\n\n            var calls = [5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100];\n            for(var i = currentCall+5 ; i <= 100; i+=5 ){\n                var btn = cc.instantiate(this.prefab_call_btn);\n                btn.parent = this.call_layout.node ;\n                var lableNode = btn.getChildByName('Background').getChildByName('Label');\n                btn.call = i;\n                lableNode.getComponent(cc.Label).string = i ;\n                btn.on(cc.Node.EventType.TOUCH_START, this.onCall, this);\n            }\n        }else if(data.statu == 'major' && data.currentplayer == sit){\n            //当前是我叫\n            this.call_node.y = 0 ;\n            //生成按钮\n\n            this.call_layout.node.removeAllChildren();\n\n            //黑\n            var btn = cc.instantiate(this.prefab_call_btn);\n            btn.parent = this.call_layout.node ;\n            var lableNode = btn.getChildByName('Background').getChildByName('Label');\n            lableNode.getComponent(cc.Label).string = '♠️' ;\n            btn.on(cc.Node.EventType.TOUCH_START, this.onMajor, this);\n            btn.major = 100;\n\n            //红\n            var btn = cc.instantiate(this.prefab_call_btn);\n            btn.parent = this.call_layout.node ;\n            var lableNode = btn.getChildByName('Background').getChildByName('Label');\n            lableNode.getComponent(cc.Label).string = '♥️' ;\n            btn.on(cc.Node.EventType.TOUCH_START, this.onMajor, this);\n            btn.major = 200;\n\n\n            //梅\n            var btn = cc.instantiate(this.prefab_call_btn);\n            btn.parent = this.call_layout.node ;\n            var lableNode = btn.getChildByName('Background').getChildByName('Label');\n            lableNode.getComponent(cc.Label).string = '♣️' ;\n            btn.on(cc.Node.EventType.TOUCH_START, this.onMajor, this);\n            btn.major = 300;\n\n            //方\n            var btn = cc.instantiate(this.prefab_call_btn);\n            btn.parent = this.call_layout.node ;\n            var lableNode = btn.getChildByName('Background').getChildByName('Label');\n            lableNode.getComponent(cc.Label).string = '♦️' ;\n            btn.on(cc.Node.EventType.TOUCH_START, this.onMajor, this);\n            btn.major = 400;\n\n        }else if(data.statu == 'holding' && data.currentplayer == sit){\n            //扣牌\n            //能选4张牌\n            this.curr_poker_num = 4;\n            this.call_node.y = 750 ;\n\n        }else{\n            this.call_node.y = 750 ;\n            this.curr_poker_num = 1;\n        }\n\n        \n\n    },\n\n    onMajor(event){\n        var major = event.target.major ;\n        this.netControl.send(' {\"method\":\"major\",\"roomId\":\"'+this.global.table+'\",\"sit\":\"'+this.global.sit+'\",\"playerId\":\"'+this.global.id+'\",\"major\":'+major+'} ');\n    \n    },\n\n    onCall(event){\n\n        var call = event.target.call ;\n        if(call == '不要'){\n            call = 0;\n        }\n        this.netControl.send(' {\"method\":\"call\",\"roomId\":\"'+this.global.table+'\",\"sit\":\"'+this.global.sit+'\",\"playerId\":\"'+this.global.id+'\",\"call\":'+call+'} ');\n    },\n\n    start () {\n        \n    },\n\n    // update (dt) {},\n});\n"]}