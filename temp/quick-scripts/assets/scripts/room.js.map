{"version":3,"sources":["room.js"],"names":["cc","Class","extends","Component","properties","out_bt","Button","voice_bt","talk_bt","ready_bt","no_ready_bt","play_bt","prefab_poker","default","type","Prefab","layout","Layout","poker_up","Sprite","poker_left","poker_down","poker_right","onLoad","util","require","curr_poker_num","curr_poker","netControl","console","log","connect","msssageFire","onfire","on","onMessage","bind","node","on_out_bt","load_pokers","pokers_","that","pokers","loader","loadResDir","SpriteFrame","err","ress","p","name","setPokers","pokersNode","instantiate","img","getChildByName","getComponent","spriteFrame","poker","parent","Node","EventType","TOUCH_START","onPoker","TOUCH_MOVE","up_poker","down_poker","left_poker","right_poker","event","currentTarget","target","curr","getPosition","y","setPosition","arrayDel","indexOf","num","push","rm_poker","shift","director","loadScene","obj","clear","start"],"mappings":"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","file":"room.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        out_bt : cc.Button,\n        voice_bt : cc.Button,\n        talk_bt : cc.Button,\n        ready_bt : cc.Button,\n        no_ready_bt : cc.Button,\n        play_bt : cc.Button,\n        prefab_poker: {\n            default: null,\n            type: cc.Prefab\n        },\n        layout : cc.Layout,\n        poker_up : cc.Sprite,\n        poker_left : cc.Sprite,\n        poker_down : cc.Sprite,\n        poker_right : cc.Sprite\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n\n        this.util = require('./util/util');\n\n        //设置当前能选几张牌\n        this.curr_poker_num = 4;\n        //当前选中的牌\n        this.curr_poker = [];\n\n         //连接服务器\n         this.netControl=require('./util/NetControl');\n         console.log(\"开始连接\");\n         this.netControl.connect();\n         console.log(\"连接完成\");\n         this.msssageFire=onfire.on(\"onmessage\",this.onMessage.bind(this));\n\n         //按钮事件\n        this.out_bt.node.on('click',this.on_out_bt,this);\n\n\n        //加载扑克牌图片资源\n        this.load_pokers();\n\n    },\n    //加载扑克牌资源\n    load_pokers(){\n        //扑克牌\n        var pokers_ = [102,103,104,105,106,107,108,109,110,111,112,113,114,\n            202,303,304,205,206,207,208,209,210,211,212,213,214,\n            302,303,304,305,306,307,308,309,310,311,312,313,314,\n            402,403,404,405,406,407,408,409,410,411,412,413,414];\n\n        var that = this;\n        that.pokers = {};\n        cc.loader.loadResDir('pokers', cc.SpriteFrame, function (err, ress) {\n            for(var p of ress){\n                that.pokers[p.name] = p;\n            }\n            that.setPokers();\n        });\n\n        \n    },\n    //设置显示的牌\n    setPokers(){\n\n        //设置当前玩家手中的牌\n        var pokers = [202,203,204,205,207,208,209,210,211,111,212,313,414,305,111,212];\n        for(var p of pokers){\n            var pokersNode = cc.instantiate(this.prefab_poker);\n            var img = pokersNode.getChildByName('img');\n            img.getComponent(cc.Sprite).spriteFrame = this.pokers[p];\n            img.poker = p;\n            pokersNode.parent = this.layout.node;\n            img.on(cc.Node.EventType.TOUCH_START, this.onPoker, this);\n            img.on(cc.Node.EventType.TOUCH_MOVE, this.onPoker, this);\n        }\n\n        //设置每个玩家出的牌\n        var up_poker = 114;\n        var down_poker = 214;\n        var left_poker = 314;\n        var right_poker = 414;\n        this.poker_up.spriteFrame = this.pokers[up_poker];\n        this.poker_down.spriteFrame = this.pokers[down_poker];\n        this.poker_left.spriteFrame = this.pokers[left_poker];\n        this.poker_right.spriteFrame = this.pokers[right_poker];\n\n    },\n    //牌事件\n    onPoker(event){\n\n        // console.log(event);\n        if(event.type == 'touchmove'){\n            if(event.currentTarget.poker != event.target.poker){\n                console.log(\"diff\");\n                console.log(currentTarget);\n                console.log(target);\n            }\n            return \n        }\n        console.log(event);\n        //点击的节点\n        var curr = event.currentTarget;\n        //移动牌\n        var p = curr.getPosition();\n        if(p.y == 25){\n            curr.setPosition(0,0);\n            //删除取消的牌\n            this.curr_poker = this.util.arrayDel(this.curr_poker, this.curr_poker.indexOf(curr) );\n        }else{\n            //根据选牌数删除多余的牌\n            curr.setPosition(0,25);\n            var num = this.curr_poker.push(curr);\n            if(num > this.curr_poker_num){\n                var rm_poker = this.curr_poker.shift();\n                rm_poker.setPosition(0,0);\n            }\n        }\n    },\n\n    //退出按钮返回到大厅\n    on_out_bt(){\n        cc.director.loadScene('hall');\n    },\n\n    onMessage:function(obj){\n        console.log(obj);\n        onfire.clear();\n    },\n\n    start () {\n\n    },\n\n    // update (dt) {},\n});\n"]}